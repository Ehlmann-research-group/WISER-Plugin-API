<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Plugin Utilities &#8212; Extending WISER  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="canonical" href="https://ehlmann-research-group.github.io/WISER-Plugin-API/plugin_utilities.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Plugin Dependencies" href="plugin_dependencies.html" />
    <link rel="prev" title="Band-Math Plugins" href="bandmath_plugins.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="plugin-utilities">
<h1>Plugin Utilities<a class="headerlink" href="#plugin-utilities" title="Link to this heading">¶</a></h1>
<p>WISER exposes 4 ways to create your own UI items that get wiser state for your plugins. These ways let you
prompt the user to choose datasets, spectra, ROIs, and bands. You access them
through <a class="reference internal" href="wiser_state.html#wiser.gui.app_state.ApplicationState" title="wiser.gui.app_state.ApplicationState"><code class="xref py py-class docutils literal notranslate"><span class="pre">wiser.gui.app_state.ApplicationState</span></code></a>. The methods are:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="p">:</span> <span class="n">RasterDataSet</span> <span class="o">=</span> <span class="n">app_state</span><span class="o">.</span><span class="n">choose_dataset_ui</span><span class="p">()</span>
<span class="n">spectrum</span><span class="p">:</span> <span class="n">Spectrm</span> <span class="o">=</span> <span class="n">app_state</span><span class="o">.</span><span class="n">choose_spectrum_ui</span><span class="p">()</span>
<span class="n">roi</span><span class="p">:</span> <span class="n">RegionOfInterest</span> <span class="o">=</span> <span class="n">app_state</span><span class="o">.</span><span class="n">choose_roi_ui</span><span class="p">()</span>
<span class="n">band</span><span class="p">:</span> <span class="n">RasterDataBand</span> <span class="o">=</span> <span class="n">app_state</span><span class="o">.</span><span class="n">choose_band_ui</span><span class="p">()</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="supporting_types.html#wiser.gui.ui_library.DynamicInputDialog" title="wiser.gui.ui_library.DynamicInputDialog"><code class="xref py py-class docutils literal notranslate"><span class="pre">wiser.gui.ui_library.DynamicInputDialog</span></code></a> provides a simple way to
collect user input that isn’t tied to WISER’s internal state. By passing in a
list of input specifications, you can dynamically generate a dialog that displays
text fields and combo boxes. This is useful for plugins or tools that need to
ask users for parameters, options, or configuration values before running. You should
not use this class directly and instead use the function <cite>ApplicationState.create_form</cite>.
Here is an example of its use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">form_inputs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s2">&quot;Enter Wavelength&quot;</span><span class="p">,</span> <span class="s2">&quot;wvl&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;Enter Divisor&quot;</span><span class="p">,</span> <span class="s2">&quot;divisor&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;Enter Dimensionality Reduction&quot;</span><span class="p">,</span> <span class="s2">&quot;dim_reduction&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;PCA&quot;</span><span class="p">,</span> <span class="s2">&quot;SVD&quot;</span><span class="p">]),</span>
    <span class="p">]</span>
<span class="n">return_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_app_state</span><span class="o">.</span><span class="n">create_form</span><span class="p">(</span>
    <span class="n">form_inputs</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Analysis Params&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;In the above text enter the parameters needed to perform the algorithm.&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This will construct a GUI element that looks like this:</p>
<img alt="_images/dynamic_plugin_input.png" src="_images/dynamic_plugin_input.png" />
<p>The class <a class="reference internal" href="supporting_types.html#wiser.gui.ui_library.TableDisplayWidget" title="wiser.gui.ui_library.TableDisplayWidget"><code class="xref py py-class docutils literal notranslate"><span class="pre">wiser.gui.ui_library.TableDisplayWidget</span></code></a> provides a way
to display the output of your code in the form of a table. You should
not use this class directly and instead use the function <cite>ApplicationState.show_table_widget</cite>.
An example of how to use it is below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">header</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Location&quot;</span><span class="p">,</span> <span class="s2">&quot;Pizza&quot;</span><span class="p">,</span> <span class="s2">&quot;Salad&quot;</span><span class="p">]</span>
<span class="n">rows</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;LA&quot;</span><span class="p">,</span> <span class="s2">&quot;10000&quot;</span><span class="p">,</span> <span class="s2">&quot;12000&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;SF&quot;</span><span class="p">,</span> <span class="s2">&quot;3000&quot;</span><span class="p">,</span> <span class="s2">&quot;3600&quot;</span><span class="p">]]</span>
<span class="bp">self</span><span class="o">.</span><span class="n">_app_state</span><span class="o">.</span><span class="n">show_table_widget</span><span class="p">(</span>
    <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
    <span class="n">rows</span><span class="o">=</span><span class="n">rows</span><span class="p">,</span>
    <span class="n">window_title</span><span class="o">=</span><span class="s2">&quot;Pizza and Salad by City&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Shows the amount of</span><span class="se">\n</span><span class="s2">pizza and salad per city.&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The class <a class="reference internal" href="supporting_types.html#wiser.gui.ui_library.MatplotlibDisplayWidget" title="wiser.gui.ui_library.MatplotlibDisplayWidget"><code class="xref py py-class docutils literal notranslate"><span class="pre">wiser.gui.ui_library.MatplotlibDisplayWidget</span></code></a> provides a way to
display matplotlib plots in a GUI element in WISER. You should
not use this class directly and instead use the function
<cite>ApplicationState.show_table_widget</cite>. An example of how to use
it through app_state is below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make some 2D data</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>

<span class="c1"># Create figure + axes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="c1"># Draw heatmap</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">)</span>

<span class="c1"># Add colorbar</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;Intensity&quot;</span><span class="p">)</span>

<span class="c1"># Add labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Random Heatmap&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;X axis&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Y axis&quot;</span><span class="p">)</span>

<span class="bp">self</span><span class="o">.</span><span class="n">_app_state</span><span class="o">.</span><span class="n">show_matplotlib_display_widget</span><span class="p">(</span>
    <span class="n">figure</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
    <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">window_title</span><span class="o">=</span><span class="s2">&quot;Simple Matplotlib Plot&quot;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Example to show the matplotlib functionality working&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>You can also use the function <cite>ApplicationState.show_spectra_in_plot</cite> to
plot a list of spectra in a spectrum plot. Here is an example of its use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test_spectrum_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="mf">0.25744912028312683</span><span class="p">,</span>
        <span class="mf">0.2996889650821686</span><span class="p">,</span>
        <span class="mf">0.07340309023857117</span><span class="p">,</span>
        <span class="mf">0.09369881451129913</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">)</span>
<span class="n">test_spectrum_x</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">472.019989</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">nanometer</span><span class="p">,</span>
    <span class="mf">532.130005</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">nanometer</span><span class="p">,</span>
    <span class="mf">702.419983</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">nanometer</span><span class="p">,</span>
    <span class="mf">852.679993</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">nanometer</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">double</span> <span class="o">=</span> <span class="n">test_spectrum_y</span> <span class="o">+</span> <span class="n">test_spectrum_y</span>
<span class="n">spec1</span> <span class="o">=</span> <span class="n">NumPyArraySpectrum</span><span class="p">(</span><span class="n">test_spectrum_y</span><span class="p">,</span> <span class="s2">&quot;Test_spectrum1&quot;</span><span class="p">,</span> <span class="n">wavelengths</span><span class="o">=</span><span class="n">test_spectrum_x</span><span class="p">)</span>
<span class="n">spec2</span> <span class="o">=</span> <span class="n">NumPyArraySpectrum</span><span class="p">(</span><span class="n">double</span><span class="p">,</span> <span class="s2">&quot;Test_spectrum2&quot;</span><span class="p">,</span> <span class="n">wavelengths</span><span class="o">=</span><span class="n">test_spectrum_x</span><span class="p">)</span>

<span class="bp">self</span><span class="o">.</span><span class="n">_app_state</span><span class="o">.</span><span class="n">show_spectra_in_plot</span><span class="p">([</span><span class="n">spec1</span><span class="p">,</span> <span class="n">spec2</span><span class="p">])</span>
</pre></div>
</div>
<p>Lastly, below is a tools menu plugin example that asks the user to first
select a dataset and then a region of interest in a tools menu plugin:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">wiser.raster.spectrum</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectrumAverageMode</span><span class="p">,</span> <span class="n">calc_roi_spectrum</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ExampleToolPlugin</span><span class="p">(</span><span class="n">ToolsMenuPlugin</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_tool_menu_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool_menu</span><span class="p">:</span> <span class="n">QMenu</span><span class="p">,</span> <span class="n">wiser</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use QMenu.addAction() to add individual actions, or QMenu.addMenu() to</span>
<span class="sd">        add sub-menus to the Tools menu.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">act</span> <span class="o">=</span> <span class="n">tool_menu</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="s2">&quot;ROI Angle Mapper&quot;</span><span class="p">)</span>
        <span class="n">act</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roi_angle_mapper</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_app_state</span> <span class="o">=</span> <span class="n">wiser</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">roi_angle_mapper</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">dataset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_app_state</span><span class="o">.</span><span class="n">choose_dataset_ui</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Description: choose dataset to perform analysis on&quot;</span><span class="p">)</span>
        <span class="n">roi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_app_state</span><span class="o">.</span><span class="n">choose_roi_ui</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Description: choose ROI to get Average Spectrum&quot;</span><span class="p">)</span>

        <span class="n">mean_roi_spec_arr</span> <span class="o">=</span> <span class="n">calc_roi_spectrum</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">SpectrumAverageMode</span><span class="o">.</span><span class="n">MEAN</span><span class="p">)</span>
        <span class="n">image_arr</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">get_image_data</span><span class="p">()</span>

        <span class="c1"># Do some math...</span>
</pre></div>
</div>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Extending WISER</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="plugins.html">WISER Plugins Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="ctxmenu_plugins.html">Context-Menu Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="toolsmenu_plugins.html">Tools-Menu Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="ui_plugins.html">GUI Plugins in WISER</a></li>
<li class="toctree-l1"><a class="reference internal" href="bandmath_plugins.html">Band-Math Plugins</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Plugin Utilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugin_dependencies.html">Plugin Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="wiser_state.html">Accessing and Modifying WISER State</a></li>
<li class="toctree-l1"><a class="reference internal" href="supporting_types.html">Supporting Types</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="bandmath_plugins.html" title="previous chapter">Band-Math Plugins</a></li>
      <li>Next: <a href="plugin_dependencies.html" title="next chapter">Plugin Dependencies</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2021, California Institute of Technology.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.4.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/plugin_utilities.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>